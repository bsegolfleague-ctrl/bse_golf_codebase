<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>Submit Score – Indoor Golf League</title>
<script src="https://cdn.tailwindcss.com"></script>

<script src="config.js"></script>
<style>
.toast {
  position: fixed; bottom: 20px; right: 20px;
  background: #333; color: #fff; padding: 10px 20px;
  border-radius: 5px; opacity: 0.9; z-index: 9999;
  font-family: Arial, sans-serif;
}
.toast-success { background: green; }
.toast-error { background: red; }
.toast-info { background: #333; }
</style>

</head>
<body class="bg-gray-100 min-h-screen">
<header class="p-4 bg-white shadow sticky top-0 z-10">
<div class="max-w-xl mx-auto flex items-center gap-3">
<a class="text-blue-600" href="index.html">← Home</a>
<h1 class="text-xl font-bold">Submit Score</h1>
</div>
</header>
<main class="p-4 max-w-xl mx-auto">
<form class="bg-white rounded-2xl p-4 shadow space-y-4" id="scoreForm">
<input class="w-full border rounded-xl p-3" name="Player" placeholder="Player" required=""/>
<input class="w-full border rounded-xl p-3" name="Course" placeholder="Course" required=""/>
<input class="w-full border rounded-xl p-3" min="1" name="Score" placeholder="Score" required="" type="number"/>
<input class="w-full border rounded-xl p-3" name="Date" required="" type="date"/>
<input class="w-full border rounded-xl p-3" name="Handicap" placeholder="Handicap (optional)" step="0.1" type="number"/>
<input class="w-full border rounded-xl p-3" name="Notes" placeholder="Notes (optional)"/>
<button class="w-full bg-green-600 text-white py-3 rounded-xl" id="submitBtn">Submit</button>
<p class="text-center text-sm text-gray-600" id="msg"></p>
</form>
</main>
<script>
// Default date to today
const today = new Date().toISOString().slice(0,10);
document.addEventListener('DOMContentLoaded', () => {
const dateInput = document.querySelector('input[name="Date"]');
if (dateInput && !dateInput.value) dateInput.value = today;
});


document.getElementById('scoreForm').addEventListener('submit', async (e) => {
e.preventDefault();
const btn = document.getElementById('submitBtn');
const msg = document.getElementById('msg');
msg.textContent = '';


if (!window.CONFIG || !API_URL) {
msg.textContent = 'Missing config.js URL';
return;
}


btn.disabled = true; btn.textContent = 'Submitting…';


const formData = new FormData(e.target);
try {
// Use URLSearchParams to keep this a simple POST (avoids CORS preflight)
const payload = new URLSearchParams(formData);
const res = await fetch(API_URL, { method: 'POST', body: payload });
if (!res.ok) throw new Error('Network error');
const json = await res.json().catch(() => ({ ok: true }));
if (json.ok) {
msg.textContent = '✅ Score submitted!';
e.target.reset();
// Reset date to today after clearing form
const dateInput = document.querySelector('input[name="Date"]');
if (dateInput && !dateInput.value) dateInput.value = today;
} else {
msg.textContent = 'Something went wrong. Check your Sheet headers.';
}
} catch (err) {
console.error(err);
msg.textContent = 'Error submitting score. Check your Web App URL & permissions.';
} finally {
btn.disabled = false; btn.textContent = 'Submit';
}
});
</script>
</body>
</html>
